{% extends "toolkit/layouts/_base_page.html" %}

{% block page_title %}
  Create account â€“ Digital Marketplace
{% endblock %}

{% block main_content %}

{% if form.errors %}
    <div class="validation-masthead" aria-labelledby="validation-masthead-heading">
        <h3 class="validation-masthead-heading" id="validation-masthead-heading">
            There was a problem with the details you gave for:
        </h3>
        <ul>
        {% for field_name, field_errors in form.errors|dictsort if field_errors %}
        {% for error in field_errors %}
          <li><a href="#{{ form[field_name].name }}" class="validation-masthead-link">{{ form[field_name].label.text }}</a></li>
        {% endfor %}
        {% endfor %}
        </ul>
    </div>
{% endif %}

{% set headings = {
    'buyer': 'Create a new Digital Marketplace account',
    'supplier': "Add your name and create a password"
   }
%}

{%
  with
  smaller = true,
  heading = headings[role],
  context = email_address
%}
  {% include "toolkit/page-heading.html" %}
{% endwith %}


    <form autocomplete="off" action="{{ url_for('.submit_create_user', encoded_token=token) }}" method="POST" id="createUserForm">

        <div class="grid-row">
            <div class="column-two-thirds">
                {{ form.hidden_tag() }}
  
                {% with question = form.name.label,
                        name = "name",
                        error = errors.get('name', {}).get('message'),
                        value = form.name.data,
                        autocomplete = "off"
                %}
                  {% include "toolkit/forms/textbox.html" %}
                {% endwith %}

                {% if role == 'buyer' %}
                  {% with question = form.phone_number.label,
                          name = "phone_number",
                          error = errors.get('phone_number', {}).get('message'),
                          hint = form.phone_number.hint,
                          value = form.phone_number.data,
                          autocomplete = "off"
                  %}
                    {% include "toolkit/forms/textbox.html" %}
                  {% endwith %}
                {% endif %}
  
                {% with question = form.password.label,
                        name = "password",
                        error = errors.get('password', {}).get('message'),
                        value = form.password.data,
                        type = "password"
                %}
                  {% include "toolkit/forms/textbox.html" %}
                {% endwith %}

                {%
                  with
                  type = "save",
                  label = "Create account"
                %}
                  {% include "toolkit/button.html" %}
                {% endwith %}
            </div>
        </div>
    </form>

{% endblock %}
